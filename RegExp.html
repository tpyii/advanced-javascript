<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RegExp</title>
  <style>
    input {
      display: block;
      margin-bottom: 1rem;
    }

    .message {
      color: red;
    }

    input.error {
      border-color: red;
    }
  </style>
</head>
<body>
<p class="text">
  One: 'Hi Mary.' Two: 'Oh, hi.'
  One: 'How are you doing?'
  Two: 'I'm doing alright. How about you?'
      One: 'Not too bad. The weather is great isn't it?'
      Two: 'Yes. It's absolutely beautiful today.'
  One: 'I wish it was like this more frequently.'
  Two: 'Me too.'
  One: 'So where are you going now?'
  Two: 'I'm going to meet a friend of mine at the department store.'
  One: 'Going to do a little shopping?'
  Two: 'Yeah, I have to buy some presents for my parents.'
  One: 'What's the occasion?'
      Two: 'It's their anniversary.'
  One: 'That's great. Well, you better get going. You don't want to be late.'
  Two: 'I'll see you next time.'
  One: 'Sure. Bye.'
</p>
<script>
  const text = document.querySelector('.text').innerText;
  
  // 1. Дан большой текст, в котором для оформления прямой речи используются одинарные кавычки. Придумать шаблон, который заменяет одинарные кавычки на двойные.
  console.log(text.replace(/'/g, '"'));

  // 2. Улучшить шаблон так, чтобы в конструкциях типа aren't одинарная кавычка не заменялась на двойную.
  console.log(text.replace(/\B'/g, '"'));
</script>

<!-- 
  3. *Создать форму обратной связи с полями: Имя, Телефон, E-mail, текст, кнопка Отправить. При нажатии на кнопку Отправить произвести валидацию полей следующим образом:
    a. Имя содержит только буквы.
    b. Телефон имеет вид +7(000)000-0000.
    c. E-mail имеет вид mymail@mail.ru, или my.mail@mail.ru, или my-mail@mail.ru.
    d. Текст произвольный.
    e. Если одно из полей не прошло валидацию, необходимо выделить это поле красной рамкой и сообщить пользователю об ошибке.
-->

<form action="#" name="validation">
  <label>Имя
    <input type="text" name="name">
  </label>
  <label>Телефон
    <input type="text" name="phone">
  </label>
  <label>E-mail
    <input type="text" name="email">
  </label>
  <input type="submit">
</form>

<script>
  /** Класс валидации формы */
  class Validation {
    /** Конструктор */
    constructor() {
      this.form = document.forms.validation;
      this.fields = this.form.querySelectorAll('input');
      this.patterns = {
        name: /^[a-zа-яё]+$/i,
        phone: /^\+7\(\d{3}\)\d{3}-\d{4}$/,
        email: /^[\w.-]+@[\w-]+\.[\w.-]{2,}$/i
      };
      this.messages = {
        name: 'Имя содержит только буквы',
        phone: 'Телефон имеет вид +7(000)000-0000',
        email: 'E-mail имеет вид mymail@mail.ru, или my.mail@mail.ru, или my-mail@mail.ru'
      };
      this.errors = [];
      this._addEventListener();
      this._checkSubmit();
    }

    /** Добавление событий */
    _addEventListener() {
      this.fields.forEach(field => {
        if (field.type !== 'submit') {
          field.addEventListener('input', (event) => this._validateField(event));
          this.errors.push(field.name);
        } else {
          this.submit = field;
          this.form.addEventListener('onsubmit', (event) => this._checkValide(event));
        }
      });
    }

    /** Проверка поля */
    _validateField(event) {
      const field = event.target;
      if (! this.patterns[field.name].test(field.value.trim())) {
          this._addError(field);
      } else {
        this._removeError(field);
      }
      this._checkSubmit();
    }

    /** Добавление сообщения об ошибки  */
    _addError(field) {
      if (! field.nextElementSibling) {
        const message = `<p class="message">${this.messages[field.name]}</p>`;
        field.parentNode.insertAdjacentHTML('beforeend', message);
        this.errors.push(field.name);
        field.classList.add('error');
      }
    }

    /** Удаление сообщения об ошибки */
    _removeError(field) {
      if (this.errors.includes(field.name)) {
        if (field.nextElementSibling) {
          field.nextElementSibling.remove();
          field.classList.remove('error');
        }
        this.errors = this.errors.filter(item => item !== field.name);
      }
    }

    /** Управление блокировкой кнопки отправки формы */
    _checkSubmit() {
      if (this.errors.length) {
        this.submit.setAttribute('disabled', true);
      } else {
        this.submit.removeAttribute('disabled');
      }
    }

    /** Проверка на возможность отправки формы */
    _checkValide(event) {
      if (this.errors.length) {
        event.preventDefault();
      }
    }
  }
  
  const form = new Validation;
</script>
</body>
</html>
